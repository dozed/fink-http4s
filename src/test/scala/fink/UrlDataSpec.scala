package fink

import fink.media.UrlData
import org.http4s.MediaType
import org.specs2.mutable.Specification

class UrlDataSpec extends Specification {

  val imageStr = "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"
  val imageData = s"data:image/png;base64,$imageStr"

  "UrlData should parse data url" in {

    val (contentType, str) = UrlData.parseParts(imageData).get

    contentType should_== MediaType.image.png
    str should_== imageStr

    val item = UrlData.parseItem(imageData).unsafeRunSync()

    item.contentType should_== MediaType.image.png

  }


}
